ksql:
    CREATE TABLE impulse_trading_screen_latest
    WITH (
        KAFKA_TOPIC = 'ksql-impulse_trading_screen_latest',
        VALUE_FORMAT = 'JSON',
        PARTITIONS = 1,
        REPLICAS = 1
    ) AS 
    SELECT
      'LATEST' AS ts_name,
      LATEST_BY_OFFSET(key->timestamp) AS latest_ts,
      LATEST_BY_OFFSET(TIMESTAMPTOSTRING(key->timestamp, 'yyyy-MM-dd')) as latest_date
    FROM impulse_momentum_signals
    GROUP BY 'LATEST'
    EMIT CHANGES;
streamsProperties:
   auto.offset.reset: earliest
   
rollback:
    ksql:
        DROP TABLE impulse_trading_screen_latest DELETE TOPIC;
    